<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adaptive Python Test Series</title>
    <!--Link to the external CSS file-->
    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
        crossorigin="anonymous"
    />
    <link rel="stylesheet" href="style.css" />
    <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
        integrity="sha512-Kc323vGBEqzQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer"
    />
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <!-- Add Chart.js for pie chart -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<style>
    #testIntro{ 
        background: linear-gradient(135deg, #ff6ac1, #7386ff);
    }
    .question-set {
        display: none;
    }
    .question-set.active {
        display: block;
    }
    .loader {
        border: 5px solid #f3f3f3;
        border-top: 5px solid #3398db;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
</style>
<body class="bg-gray-100 font-sans">
    <!--Nav bar copied-->
    <div class="main-hero">
        <nav class="navbar navbar-expand-lg bg-body-light sticky-top">
          <div class="container-fluid">
            <a class="navbar-brand" href="index.html">
                <div style="display: flex; align-items: center;">
                    <img
                        width="40"
                        height="40"
                        src="https://img.icons8.com/ios/50/education.png"
                        alt="education"
                    />&nbsp;
                    <b style="color: #e9cedf !important;">Code Quest</b>
                </div>
            </a>
            <button
              class="navbar-toggler"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navbarSupportedContent"
              aria-controls="navbarSupportedContent"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavDropdown">
              <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false" >
                    Test Series
                  </a>
                  <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                    <a class="dropdown-item" href="java-test.html">Java</a>
                    <a class="dropdown-item" href="python-test.html">Python</a>
                    <a class="dropdown-item" href="cpp-test.html">C++</a>
                  </div>
                </li>
                <li>
                  <a class="nav-link" href="ai-quiz-generator.html">Quiz Generator</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="index.html">Home</a>
                </li>
              </ul>
              <form class="d-flex ms-2" role="search">
                <button
                  class="btn rounded-pill px-4 me-2"
                  type="submit"
                  style="font-size: 0.9rem !important; background-color: #ff9f67"
                >
                <a href="/signup.html" style="text-decoration: none; color: white;">Sign Up</a>
                </button>
              </form>
              <form class="d-flex" role="search">
                <button
                  class="btn rounded-pill px-4 me-2"
                  type="submit"
                  style="font-size: 0.9rem !important; background-color: #ff9f67; color: white !important;"
                >
                <a href="/login.html" style="text-decoration: none;">Login</a>
                </button>
              </form>
            </div>
          </div>
        </nav>
    </div>
    <!--Nav bar copied-->
    <div class="bg-gray-100 font-sans">
    <main class="container mx-auto px-6 py-8">
        <section id="testIntro" class="bg-white shadow-md rounded-lg p-6 mb-6">
            <h1 class="text-3xl font-bold text-gray-800 mb-4">Adaptive Python Test Series</h1>
            <p class="text-gray-600 mb-6">Choose your level and start testing your Python knowledge!</p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-2">Basic Level</h2>
                    <p class="text-gray-600 mb-4">20 adaptive questions covering basic Python concepts.</p>
                    <button id="basicBtn" onclick="startTest('basic')" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded transition duration-300">
                        Start Test
                    </button>
                </div>
                <div class="bg-white rounded-lg shadow-md p-6" id="intermediateCard">
                    <h2 class="text-xl font-semibold text-gray-800 mb-2">Intermediate Level</h2>
                    <p class="text-gray-600 mb-4">20 adaptive questions covering intermediate Python concepts.</p>
                    <button id="intermediateBtn" onclick="startTest('intermediate')" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded transition duration-300">
                        Start Test
                    </button>
                </div>
                <div class="bg-white rounded-lg shadow-md p-6" id="advancedCard">
                    <h2 class="text-xl font-semibold text-gray-800 mb-2">Advanced Level</h2>
                    <p class="text-gray-600 mb-4">20 adaptive questions covering advanced Python concepts.</p>
                    <button id="advancedBtn" onclick="startTest('advanced')" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded transition duration-300">
                        Start Test
                    </button>
                </div>
            </div>
        </section>

        <section id="testSection" class="hidden bg-white shadow-md rounded-lg p-6">
            <h2 id="testLevelTitle" class="text-2xl font-bold text-gray-800 mb-4"></h2>
            <div id="timer" class="text-xl font-semibold text-gray-700 mb-4"></div>
            <div id="questionSetNav" class="mb-4 flex space-x-4">
                <button id="prevSet" class="bg-blue-500 text-white px-4 py-2 rounded transition duration-300" onclick="showQuestionSet('first')" disabled>Previous</button>
                <button id="nextSet" class="bg-blue-500 text-white px-4 py-2 rounded transition duration-300" onclick="showQuestionSet('second')" style="display: none !important;">Next</button>
            </div>
            <div id="questions" class="space-y-6">
                <div id="firstSet" class="question-set active"></div>
                <div id="secondSet" class="question-set"></div>
            </div>
            <div id="loader" class="hidden flex justify-center items-center my-8">
                <div class="loader"></div>
            </div>
            <button onclick="submitTest()" class="mt-6 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded transition duration-300">
                Submit Test
            </button>
        </section>

        <section id="scoreSection" class="hidden bg-white shadow-md rounded-lg p-6">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Test Results</h2>
            <div class="flex flex-col md:flex-row md:space-x-6 space-y-6 md:space-y-0">
                <div class="w-full md:w-1/2">
                    <canvas id="scoreChart" width="100%" height="300"></canvas>
                </div>
                <div class="w-full md:w-1/2">
                    <canvas id="topicChart" width="100%" height="300"></canvas>
                </div>
            </div>
            <div id="comprehensiveResults" class="space-y-4 mt-6">
                <p class="text-gray-700">Correct Answers: <span id="correctAnswers" class="font-semibold"></span></p>
                <p class="text-gray-700">Incorrect Answers: <span id="incorrectAnswers" class="font-semibold"></span></p>
            </div>
            <div class="mt-6 flex justify-center space-x-4">
                <button id="retryBtn" onclick="retryTest()" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded transition duration-300">
                    Retry
                </button>
                <button id="nextLevelBtn" onclick="goToNextLevel()" class="hidden bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded transition duration-300">
                    Go to Next Level
                </button>
            </div>
        </section>
    </main>
</div>

    <!-- Add Bootstrap JS for dropdown functionality -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        const questions = {
            basic: [
                { question: "What is Python?", options: ["A programming language", "A snake", "A movie", "A game"], correct: 0 },
                { question: "Who created Python?", options: ["Guido van Rossum", "James Gosling", "Dennis Ritchie", "Bjarne Stroustrup"], correct: 0 },
                { question: "What is the correct extension for Python files?", options: [".java", ".py", ".txt", ".pyt"], correct: 1 },
                { question: "Which keyword is used to define a function in Python?", options: ["func", "function", "def", "declare"], correct: 2 },
                { question: "How do you create a comment in Python?", options: ["//", "#", "/*", "<!-- -->"], correct: 1 },
                { question: "Which of these is a Python data type?", options: ["int", "char", "float", "all of the above"], correct: 3 },
                { question: "What does 'len()' do in Python?", options: ["Returns the length of a list", "Returns the length of a string", "Both A and B", "None of the above"], correct: 2 },
                { question: "What is a correct syntax to output 'Hello World' in Python?", options: ["echo 'Hello World'", "p('Hello World')", "print('Hello World')", "System.out.println('Hello World')"], correct: 2 },
                { question: "How do you declare a variable in Python?", options: ["var x = 10", "x = 10", "int x = 10", "x <- 10"], correct: 1 },
                { question: "Which Python data structure is unordered and mutable?", options: ["List", "Tuple", "Dictionary", "Set"], correct: 3 }
            ],
            intermediate: [
                { question: "What is a lambda function?", options: ["An anonymous function", "A function with no arguments", "A recursive function", "A named function"], correct: 0 },
                { question: "What does 'self' represent in Python classes?", options: ["The current object", "The parent class", "The module", "None of the above"], correct: 0 },
                { question: "Which module is used to work with regular expressions?", options: ["re", "regex", "express", "expression"], correct: 0 },
                { question: "How do you import a module in Python?", options: ["module import", "import module", "load module", "require module"], correct: 1 },
                { question: "Which of these is a valid list comprehension?", options: ["[x for x in range(5)]", "{x for x in range(5)}", "(x for x in range(5))", "x in range(5)"], correct: 0 },
                { question: "Which method is used to add an item to a list?", options: ["add()", "append()", "insert()", "push()"], correct: 1 },
                { question: "Which of these is a valid Python set?", options: ["{1, 2, 3}", "[1, 2, 3]", "(1, 2, 3)", "{'key': 'value'}"], correct: 0 },
                { question: "What is the difference between '==' and 'is'?", options: ["No difference", "'==' checks value, 'is' checks identity", "'==' checks identity, 'is' checks value", "None of the above"], correct: 1 },
                { question: "Which keyword is used to create a class in Python?", options: ["class", "object", "new", "def"], correct: 0 },
                { question: "Which of the following is a Python immutable data type?", options: ["List", "Dictionary", "Tuple", "Set"], correct: 2 }
            ],
            advanced: [
                { question: "What is a decorator in Python?", options: ["A function that takes another function as an argument", "A function that returns a lambda", "A function that creates a new class", "A built-in Python function"], correct: 0 },
                { question: "Which module is used for multiprocessing in Python?", options: ["threading", "multiprocessing", "asyncio", "parallel"], correct: 1 },
                { question: "What does the 'yield' keyword do?", options: ["Returns a generator object", "Stops execution of a function", "Pauses execution of a function", "None of the above"], correct: 2 },
                { question: "What is the Global Interpreter Lock (GIL) in Python?", options: ["A lock that allows only one thread to execute at a time", "A lock that speeds up multithreading", "A lock that allows parallel execution", "None of the above"], correct: 0 },
                { question: "What is a metaclass in Python?", options: ["A class that defines other classes", "A class that cannot be instantiated", "A class with no methods", "A class with private attributes"], correct: 0 },
                { question: "Which module is used to work with dates and times?", options: ["datetime", "time", "calendar", "dates"], correct: 0 },
                { question: "What is a context manager in Python?", options: ["A class that manages memory", "A class that manages resources", "A class that manages variables", "None of the above"], correct: 1 },
                { question: "Which Python built-in function is used to filter elements from a list?", options: ["filter()", "map()", "reduce()", "sort()"], correct: 0 },
                { question: "How do you create a virtual environment in Python?", options: ["virtualenv myenv", "python -m venv myenv", "python create venv", "venv create myenv"], correct: 1 },
                { question: "What does the 'assert' statement do?", options: ["Tests a condition", "Raises an exception", "Executes a block of code", "Checks for syntax errors"], correct: 0 }
            ]
        };
        
        // Add topic categorization for questions
        const topics = {
            basic: ["Fundamentals", "Syntax", "Data Types", "Built-ins", "Variables"],
            intermediate: ["Functions", "Classes", "Modules", "Data Structures", "Comparison"],
            advanced: ["Advanced Functions", "Concurrency", "Generators", "Internals", "Meta Programming"]
        };
        
        let timer;
        let timeLeft = 10 * 60; // 10 minutes
        let currentLevel = '';
        let correctCount = 0;
        let totalQuestions = 10;
        let userAnswers = [];
        
        // Add locked class to intermediate and advanced initially (if not already completed)
        document.addEventListener('DOMContentLoaded', function() {
            // Check if intermediate is locked from localStorage or set it to locked by default
            const intermediateUnlocked = localStorage.getItem('intermediateUnlocked') === 'true';
            const advancedUnlocked = localStorage.getItem('advancedUnlocked') === 'true';
            
            if (!intermediateUnlocked) {
                document.getElementById('intermediateCard').classList.add('opacity-50');
                document.getElementById('intermediateBtn').disabled = true;
            }
            
            if (!advancedUnlocked) {
                document.getElementById('advancedCard').classList.add('opacity-50');
                document.getElementById('advancedBtn').disabled = true;
            }
        });

        function startTest(level) {
            currentLevel = level;
            document.getElementById('testIntro').classList.add('hidden');
            document.getElementById('testSection').classList.remove('hidden');
            document.getElementById('testLevelTitle').innerText = `${capitalize(level)} Level Python Test`;
            
            // Reset user answers
            userAnswers = [];
            
            // Generate question set
            const firstSetContainer = document.getElementById('firstSet');
            const secondSetContainer = document.getElementById('secondSet');
            firstSetContainer.innerHTML = '';
            secondSetContainer.innerHTML = '';
            
            const levelQuestions = questions[level];
            totalQuestions = levelQuestions.length;
            
            // First half of questions goes in first set
            const midpoint = Math.ceil(levelQuestions.length / 2);
            
            // Generate first set
            levelQuestions.slice(0, midpoint).forEach((q, index) => {
                firstSetContainer.innerHTML += `
                    <div class="mb-8 p-4 bg-gray-50 rounded-lg">
                        <p class="font-semibold text-lg mb-3">${index + 1}. ${q.question}</p>
                        <div class="space-y-2">
                            ${q.options.map((opt, i) => `
                                <div class="flex items-center">
                                    <input type="radio" id="q${index}_opt${i}" name="question${index}" value="${i}" class="mr-2" />
                                    <label for="q${index}_opt${i}">${opt}</label>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            });
            
            // Generate second set
            levelQuestions.slice(midpoint).forEach((q, index) => {
                const actualIndex = index + midpoint;
                secondSetContainer.innerHTML += `
                    <div class="mb-8 p-4 bg-gray-50 rounded-lg">
                        <p class="font-semibold text-lg mb-3">${actualIndex + 1}. ${q.question}</p>
                        <div class="space-y-2">
                            ${q.options.map((opt, i) => `
                                <div class="flex items-center">
                                    <input type="radio" id="q${actualIndex}_opt${i}" name="question${actualIndex}" value="${i}" class="mr-2" />
                                    <label for="q${actualIndex}_opt${i}">${opt}</label>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            });
            
            // Setup navigation
            if (levelQuestions.length > midpoint) {
                document.getElementById('nextSet').style.display = 'block';
            }
            
            // Show first set, hide second set
            document.getElementById('firstSet').classList.add('active');
            document.getElementById('secondSet').classList.remove('active');
            
            startTimer();
        }
        
        function showQuestionSet(set) {
            if (set === 'first') {
                document.getElementById('firstSet').classList.add('active');
                document.getElementById('secondSet').classList.remove('active');
                document.getElementById('prevSet').disabled = true;
                document.getElementById('nextSet').disabled = false;
            } else {
                document.getElementById('firstSet').classList.remove('active');
                document.getElementById('secondSet').classList.add('active');
                document.getElementById('prevSet').disabled = false;
                document.getElementById('nextSet').disabled = true;
            }
        }

        function startTimer() {
            timeLeft = 10 * 60; // Reset to 10 minutes
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    submitTest();
                }
            }, 1000);
        }
        
        function updateTimerDisplay() {
            let minutes = Math.floor(timeLeft / 60);
            let seconds = timeLeft % 60;
            document.getElementById('timer').innerText = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
        }

        function submitTest() {
            clearInterval(timer);
            
            // Show loader
            document.getElementById('loader').classList.remove('hidden');
            
            // Simulate processing time
            setTimeout(() => {
                const levelQuestions = questions[currentLevel];
                correctCount = 0;
                const topicResults = {};
                
                // Initialize topic results
                topics[currentLevel].forEach(topic => {
                    topicResults[topic] = { correct: 0, total: 0 };
                });
                
                // Calculate results
                levelQuestions.forEach((q, index) => {
                    const selectedOption = document.querySelector(`input[name="question${index}"]:checked`);
                    const isCorrect = selectedOption && parseInt(selectedOption.value) === q.correct;
                    
                    if (isCorrect) {
                        correctCount++;
                    }
                    
                    // Track topic performance (simplified - using index to determine topic)
                    const topicIndex = Math.floor(index / (levelQuestions.length / topics[currentLevel].length));
                    const topic = topics[currentLevel][topicIndex];
                    
                    if (topic) {
                        topicResults[topic].total++;
                        if (isCorrect) {
                            topicResults[topic].correct++;
                        }
                    }
                });
                
                const incorrectCount = totalQuestions - correctCount;
                
                document.getElementById('correctAnswers').innerText = correctCount;
                document.getElementById('incorrectAnswers').innerText = incorrectCount;
                
                // Set up score chart
                const scoreCtx = document.getElementById('scoreChart').getContext('2d');
                new Chart(scoreCtx, {
                    type: 'pie',
                    data: {
                        labels: ['Correct', 'Incorrect'],
                        datasets: [{
                            data: [correctCount, incorrectCount],
                            backgroundColor: ['#28a745', '#dc3545'],
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom',
                            },
                            title: {
                                display: true,
                                text: 'Score Distribution'
                            }
                        }
                    }
                });
                
                // Set up topic performance chart
                const topicCtx = document.getElementById('topicChart').getContext('2d');
                const topicLabels = Object.keys(topicResults);
                const topicData = topicLabels.map(topic => 
                    topicResults[topic].total > 0 ? 
                    (topicResults[topic].correct / topicResults[topic].total) * 100 : 0
                );
                
                new Chart(topicCtx, {
                    type: 'bar',
                    data: {
                        labels: topicLabels,
                        datasets: [{
                            label: 'Performance by Topic (%)',
                            data: topicData,
                            backgroundColor: 'rgba(54, 162, 235, 0.5)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100
                            }
                        },
                        plugins: {
                            title: {
                                display: true,
                                text: 'Topic Performance'
                            }
                        }
                    }
                });
                
                // Hide loader and show results
                document.getElementById('loader').classList.add('hidden');
                document.getElementById('testSection').classList.add('hidden');
                document.getElementById('scoreSection').classList.remove('hidden');
                
                // Show next level button if score is high enough
                if (correctCount >= Math.ceil(totalQuestions * 0.7)) { // 70% correct to unlock next level
                    document.getElementById('nextLevelBtn').classList.remove('hidden');
                } else {
                    document.getElementById('nextLevelBtn').classList.add('hidden');
                }
            }, 1500);
        }

        function goToNextLevel() {
            if (currentLevel === 'basic') {
                document.getElementById('intermediateCard').classList.remove('opacity-50');
                document.getElementById('intermediateBtn').disabled = false;
                localStorage.setItem('intermediateUnlocked', 'true');
            } else if (currentLevel === 'intermediate') {
                document.getElementById('advancedCard').classList.remove('opacity-50');
                document.getElementById('advancedBtn').disabled = false;
                localStorage.setItem('advancedUnlocked', 'true');
            }
            document.getElementById('scoreSection').classList.add('hidden');
            document.getElementById('testIntro').classList.remove('hidden');
        }

        function retryTest() {
            document.getElementById('scoreSection').classList.add('hidden');
            document.getElementById('testIntro').classList.remove('hidden');
        }

        function capitalize(str) {
            return str.charAt(0).toUpperCase() + str.slice(1);
        }
    </script>
</body>
</html>